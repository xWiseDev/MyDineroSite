---
import SEOHead from '@/components/global/SEOHead.astro';
import Header from '@/components/global/Header.astro';
import Footer from '@/components/global/Footer.astro';
import '@/styles/global.css';
import '@/styles/animations.css';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  url?: string;
  type?: 'website' | 'article';
  noindex?: boolean;
  includeAppSchema?: boolean;
  hideHeader?: boolean;
  hideFooter?: boolean;
}

const {
  title,
  description,
  image,
  url = Astro.url.pathname,
  type = 'website',
  noindex = false,
  includeAppSchema = false,
  hideHeader = false,
  hideFooter = false
} = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <SEOHead
      title={title}
      description={description}
      image={image}
      url={url}
      type={type}
      noindex={noindex}
      includeAppSchema={includeAppSchema}
    />
  </head>
  <body>
    {!hideHeader && <Header />}

    <main>
      <slot />
    </main>

    {!hideFooter && <Footer />}

    <!-- Scroll Animation Script -->
    <script>
      // Intersection Observer for scroll animations
      const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            // Optionally unobserve after animation
            // observer.unobserve(entry.target);
          }
        });
      }, observerOptions);

      // Observe all elements with scroll-animate class
      document.querySelectorAll('.scroll-animate').forEach(el => {
        observer.observe(el);
      });

      // Navigation scroll effect
      const header = document.querySelector('.header');
      if (header) {
        let lastScroll = 0;
        window.addEventListener('scroll', () => {
          const currentScroll = window.pageYOffset;

          if (currentScroll > 50) {
            header.classList.add('nav-scrolled');
          } else {
            header.classList.remove('nav-scrolled');
          }

          lastScroll = currentScroll;
        }, { passive: true });
      }
    </script>
  </body>
</html>
