---
interface Props {
  image?: string;
  alt?: string;
  float?: boolean;
  glow?: boolean;
  class?: string;
}

const {
  image = '/images/hero-iphone.png',
  alt = 'MyDinero app screenshot',
  float = true,
  glow = true,
  class: className = ''
} = Astro.props;

// Prefix local paths with BASE_URL
const imageSrc = image.startsWith('/') ? `${import.meta.env.BASE_URL}${image.slice(1)}` : image;
---

<div
  class:list={[
    'phone-mockup',
    { 'phone-float': float, 'phone-glow': glow },
    className
  ]}
>
  <div class="phone-frame">
    <div class="phone-notch"></div>
    <div class="phone-screen">
      {image ? (
        <img
          src={imageSrc}
          alt={alt}
          loading="lazy"
          class="phone-image"
        />
      ) : (
        <div class="phone-placeholder">
          <slot />
        </div>
      )}
    </div>
  </div>
</div>

<style>
  .phone-mockup {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .phone-frame {
    position: relative;
    width: 280px;
    height: 570px;
    background: linear-gradient(145deg, #2c2c2e, #1a1a1a);
    border-radius: 45px;
    padding: 12px;
    box-shadow:
      0 25px 50px -12px rgba(0, 0, 0, 0.7),
      0 0 0 1px rgba(255, 255, 255, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }

  .phone-notch {
    position: absolute;
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 32px;
    background-color: #000;
    border-radius: 20px;
    z-index: 10;
  }

  .phone-screen {
    width: 100%;
    height: 100%;
    background-color: #000;
    border-radius: 35px;
    overflow: hidden;
    position: relative;
  }

  .phone-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top;
  }

  .phone-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(180deg, var(--color-gray-900), var(--color-black));
    color: var(--color-white-50);
    font-size: var(--font-size-sm);
    text-align: center;
    padding: var(--space-4);
  }

  /* Float animation */
  .phone-float {
    animation: phone-float 6s ease-in-out infinite;
  }

  @keyframes phone-float {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-15px);
    }
  }

  /* Glow effect */
  .phone-glow .phone-frame {
    box-shadow:
      0 25px 50px -12px rgba(0, 0, 0, 0.7),
      0 0 0 1px rgba(255, 255, 255, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.1),
      0 0 80px rgba(52, 199, 89, 0.2);
  }

  .phone-glow {
    animation: phone-glow 4s ease-in-out infinite;
  }

  @keyframes phone-glow {
    0%, 100% {
      filter: drop-shadow(0 0 20px rgba(52, 199, 89, 0.2));
    }
    50% {
      filter: drop-shadow(0 0 40px rgba(52, 199, 89, 0.3));
    }
  }

  /* Responsive */
  @media (max-width: 480px) {
    .phone-frame {
      width: 240px;
      height: 490px;
      border-radius: 38px;
      padding: 10px;
    }

    .phone-notch {
      width: 100px;
      height: 28px;
      top: 10px;
    }

    .phone-screen {
      border-radius: 30px;
    }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .phone-float,
    .phone-glow {
      animation: none;
    }
  }
</style>
